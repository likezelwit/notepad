<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Garden Notepad ‚Äî Final</title>

<link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<style>
:root{
  --green:#7fc8a9;
  --paper:#fffdf7;
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:Quicksand,sans-serif;
  background:linear-gradient(#e6fff5,#eaf3ff);
  height:100vh;
  overflow:hidden;
}
header{
  display:flex;
  align-items:center;
  gap:12px;
  padding:14px;
}
.logo{
  width:42px;height:42px;
  border-radius:12px;
  background:var(--green);
  color:#fff;
  display:flex;
  align-items:center;
  justify-content:center;
}
#notes{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(180px,1fr));
  gap:14px;
  padding:14px;
  overflow:auto;
  height:calc(100vh - 70px);
}
.note-card{
  background:#fff;
  border-radius:14px;
  padding:12px;
  cursor:pointer;
  box-shadow:0 4px 10px rgba(0,0,0,.06);
  position:relative;
}
.note-card small{color:#666}
.note-card.add{
  border:2px dashed var(--green);
  text-align:center;
  color:var(--green);
  font-weight:600;
}
.note-card button{
  position:absolute;
  top:8px;right:8px;
  border:none;
  background:#fff;
  cursor:pointer;
}

#editorView{
  position:fixed;
  inset:0;
  background:#eef5ee;
  display:none;
  flex-direction:column;
}
#editorView.active{display:flex}

.topbar{
  display:flex;
  gap:8px;
  align-items:center;
  padding:10px;
  background:#fff;
}
.topbar input{
  flex:1;
  border:none;
  font-size:18px;
  outline:none;
}

.toolbar{
  display:flex;
  gap:6px;
  padding:8px;
  background:#fff;
}
.toolbar button{
  width:36px;height:36px;
  border:none;
  border-radius:10px;
  cursor:pointer;
}

.workspace{
  flex:1;
  overflow:auto;
  display:flex;
  justify-content:center;
  padding:20px;
}
.paper{
  background:var(--paper);
  width:820px;
  min-height:1100px;
  padding:40px;
  position:relative;
}
.editor{
  min-height:900px;
  outline:none;
}

.sticker{
  position:absolute;
  cursor:grab;
  font-size:40px;
}

.page-nav{
  position:fixed;
  bottom:20px;
  right:20px;
  display:flex;
  gap:6px;
  background:#fff;
  padding:8px 12px;
  border-radius:20px;
}
.page-nav button{
  width:34px;height:34px;
  border-radius:50%;
  border:1px solid #ccc;
  background:#fff;
  cursor:pointer;
}
.page-nav button.active{
  background:var(--green);
  color:#fff;
  border-color:var(--green);
}
</style>
</head>

<body>

<header>
  <div class="logo">üåø</div>
  <div>
    <b>Garden Notepad</b><br>
    <small>Final Stable</small>
  </div>
</header>

<div id="notes"></div>

<div id="editorView">
  <div class="topbar">
    <button onclick="closeEditor()"><i class="fas fa-arrow-left"></i></button>
    <input id="titleInput" placeholder="Judul catatan">
    <small id="saveStatus"></small>
  </div>

  <div class="toolbar">
    <button onclick="cmd('bold')"><i class="fas fa-bold"></i></button>
    <button onclick="cmd('italic')"><i class="fas fa-italic"></i></button>
    <button onclick="addSticker('üå∏')">üå∏</button>
    <button onclick="addSticker('ü¶ã')">ü¶ã</button>
    <button onclick="addSticker('üçÉ')">üçÉ</button>
  </div>

  <div class="workspace">
    <div class="paper" id="paper">
      <div id="editor" class="editor" contenteditable></div>
    </div>
  </div>

  <div class="page-nav" id="pageNav"></div>
</div>

<script>
const KEY='garden_notes_final';
let notes=JSON.parse(localStorage.getItem(KEY)||'[]');
let note=null;
let page=1;

const notesEl=document.getElementById('notes');
const editorView=document.getElementById('editorView');
const editor=document.getElementById('editor');
const paper=document.getElementById('paper');
const titleInput=document.getElementById('titleInput');
const pageNav=document.getElementById('pageNav');
const saveStatus=document.getElementById('saveStatus');

function saveAll(){
  localStorage.setItem(KEY,JSON.stringify(notes));
  saveStatus.textContent='disimpan';
  setTimeout(()=>saveStatus.textContent='',800);
}

function renderNotes(){
  notesEl.innerHTML='';
  const add=document.createElement('div');
  add.className='note-card add';
  add.textContent='+ Catatan Baru';
  add.onclick=createNote;
  notesEl.appendChild(add);

  notes.forEach(n=>{
    const d=document.createElement('div');
    d.className='note-card';
    d.innerHTML=`<b>${n.title||'Tanpa Judul'}</b><br><small>${new Date(n.updated).toLocaleDateString()}</small>
    <button onclick="event.stopPropagation();deleteNote('${n.id}')">‚úï</button>`;
    d.onclick=()=>openNote(n.id);
    notesEl.appendChild(d);
  });
}

function createNote(){
  note={
    id:Date.now().toString(),
    title:'',
    pages:{1:{text:'',stickers:[]}},
    total:1,
    updated:Date.now()
  };
  notes.unshift(note);
  openEditor();
}

function openNote(id){
  note=notes.find(n=>n.id===id);
  openEditor();
}

function deleteNote(id){
  if(confirm('Hapus catatan?')){
    notes=notes.filter(n=>n.id!==id);
    saveAll();
    renderNotes();
  }
}

function openEditor(){
  editorView.classList.add('active');
  titleInput.value=note.title;
  page=1;
  loadPage();
  renderPages();
}

function closeEditor(){
  savePage();
  note.title=titleInput.value;
  note.updated=Date.now();
  saveAll();
  editorView.classList.remove('active');
  renderNotes();
}

function cmd(c){document.execCommand(c);}

function savePage(){
  note.pages[page].text=editor.innerHTML;
}

function loadPage(){
  editor.innerHTML=note.pages[page].text||'';
  document.querySelectorAll('.sticker').forEach(s=>s.remove());
  note.pages[page].stickers.forEach(s=>{
    const el=document.createElement('div');
    el.className='sticker';
    el.textContent=s.e;
    el.style.left=s.x;
    el.style.top=s.y;
    dragSticker(el);
    paper.appendChild(el);
  });
}

function renderPages(){
  pageNav.innerHTML='';
  for(let i=1;i<=note.total;i++){
    const b=document.createElement('button');
    b.textContent=i;
    if(i===page) b.classList.add('active');
    b.onclick=()=>{
      savePage();
      page=i;
      loadPage();
      renderPages();
    };
    pageNav.appendChild(b);
  }
  const add=document.createElement('button');
  add.textContent='+';
  add.onclick=()=>{
    savePage();
    note.total++;
    note.pages[note.total]={text:'',stickers:[]};
    page=note.total;
    loadPage();
    renderPages();
  };
  pageNav.appendChild(add);
}

function addSticker(e){
  const s=document.createElement('div');
  s.className='sticker';
  s.textContent=e;
  s.style.left='120px';
  s.style.top='120px';
  dragSticker(s);
  paper.appendChild(s);
  note.pages[page].stickers.push({e,x:s.style.left,y:s.style.top});
}

function dragSticker(el){
  el.onmousedown=ev=>{
    const ox=ev.offsetX,oy=ev.offsetY;
    document.onmousemove=m=>{
      el.style.left=m.pageX-ox+'px';
      el.style.top=m.pageY-oy+'px';
    };
    document.onmouseup=()=>{
      document.onmousemove=null;
      note.pages[page].stickers=[...document.querySelectorAll('.sticker')]
        .map(s=>({e:s.textContent,x:s.style.left,y:s.style.top}));
      saveAll();
    };
  };
}

editor.addEventListener('input',()=>{savePage();saveAll();});
titleInput.addEventListener('input',saveAll);

renderNotes();
</script>
</body>
</html>
